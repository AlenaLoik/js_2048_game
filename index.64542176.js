var t;t=new(function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),this.defaultState=t?JSON.parse(JSON.stringify(t)):null,this.board=t||[,,,,].fill(0).map(function(){return[,,,,].fill(0)}),this.score=0,this.status="idle"}return t=[{key:"moveLeft",value:function(){this.move(function(t){return t.filter(function(t){return t}).concat(Array(4-t.filter(function(t){return t}).length).fill(0))})}},{key:"moveRight",value:function(){this.move(function(t){return Array(4-t.filter(function(t){return t}).length).fill(0).concat(t.filter(function(t){return t}))})}},{key:"moveUp",value:function(){this.transposeAndMove("up")}},{key:"moveDown",value:function(){this.transposeAndMove("down")}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){"playing"!==this.status&&(this.status="playing"),this.spawnTile(),this.spawnTile()}},{key:"restart",value:function(){var t=[,,,,].fill(0).map(function(){return[,,,,].fill(0)});this.board=this.defaultState?JSON.parse(JSON.stringify(this.defaultState)):t,this.score=0,this.status="idle"}},{key:"move",value:function(t){if("playing"===this.status){var e=JSON.stringify(this.board);this.board=this.board.map(t),this.mergeTiles(t),JSON.stringify(this.board)!==e&&(this.spawnTile(),this.checkGameState())}}},{key:"mergeTiles",value:function(t){var e=this;this.board=this.board.map(function(n){for(var r=0;r<n.length-1;r++)n[r]===n[r+1]&&0!==n[r]&&(n[r]*=2,n[r+1]=0,e.score+=n[r]);return t(n)})}},{key:"spawnTile",value:function(){var t=[];if(this.board.forEach(function(e,n){return e.forEach(function(e,r){0===e&&t.push({rowIndex:n,colIndex:r})})}),t.length>0){var e=t[Math.floor(Math.random()*t.length)],n=e.rowIndex,r=e.colIndex;this.board[n][r]=.9>Math.random()?2:4}}},{key:"checkGameState",value:function(){this.board.flat().includes(2048)?this.status="win":this.hasMoves()||(this.status="lose"),this.updateUI()}},{key:"hasMoves",value:function(){if(this.board.flat().includes(0))return!0;for(var t=0;t<4;t++)for(var e=0;e<4;e++)if(t<3&&this.board[t][e]===this.board[t+1][e]||e<3&&this.board[t][e]===this.board[t][e+1])return!0;return!1}},{key:"transposeAndMove",value:function(t){var e=this;if("playing"===this.status){var n=JSON.stringify(this.board),r=this.board[0].map(function(t,n){return e.board.map(function(t){return t[n]})}).map(function(n){return"up"===t?e.mergeAndSlide(n):e.mergeAndSlide(n.reverse()).reverse()});this.board=r[0].map(function(t,e){return r.map(function(t){return t[e]})}),JSON.stringify(this.board)!==n&&(this.spawnTile(),this.checkGameState())}}},{key:"mergeAndSlide",value:function(t){for(var e=t.filter(function(t){return 0!==t}),n=[],r=0;r<e.length;)e[r]===e[r+1]?(n.push(2*e[r]),this.score+=2*e[r],r+=2):(n.push(e[r]),r++);return n.concat(Array(4-n.length).fill(0))}},{key:"updateUI",value:function(){}}],function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(e.prototype,t),e}()),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".button.start"),n=document.querySelector(".game-score"),r=document.querySelectorAll(".field-cell"),a=document.querySelector(".message-lose"),i=document.querySelector(".message-win"),s=document.querySelector(".message-start"),o=function(){var e=t.getState(),o=t.getScore(),u=t.getStatus();r.forEach(function(t,n){var r=e[Math.floor(n/4)][n%4];t.textContent=0===r?"":r,t.className="field-cell ".concat(r>0?"field-cell--".concat(r):"")}),n.textContent=o,a.classList.toggle("hidden","lose"!==u),i.classList.toggle("hidden","win"!==u),s.classList.toggle("hidden","idle"!==u)};e.addEventListener("click",function(){"idle"===t.getStatus()?(e.textContent="Restart",e.classList.remove("start"),e.classList.add("restart"),t.start()):(e.textContent="Start",e.classList.remove("restart"),e.classList.add("start"),t.restart()),o()}),document.addEventListener("keydown",function(e){if("playing"===t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;default:return}o()}}),o()});
//# sourceMappingURL=index.64542176.js.map
